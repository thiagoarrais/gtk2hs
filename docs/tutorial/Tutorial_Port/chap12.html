<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 11 February 2007), see www.w3.org">
  <meta http-equiv="CONTENT-TYPE" content=
  "text/html; charset=us-ascii">

  <title>Spin Buttons</title>
</head>

<body lang="en-US" text="#000000" link="#0000FF" vlink="#840084"
bgcolor="#FFFFFF" dir="ltr">
  <table summary="links to other pages" width="100%" border="0"
  cellpadding="0" cellspacing="0">
    <tr>
      <th colspan="3">
        <p align="center">Gtk2Hs Tutorial</p>
      </th>
    </tr>

    <tr valign="bottom">
      <td width="10%">
        <p align="left"><a href="chap11.html">&lt;&lt;&lt;
        Previous</a></p>
      </td>

      <td width="80%">
        <p align="center">Next</p>
      </td><!--
                <TD WIDTH=10%>
                        <P ALIGN=RIGHT><A HREF="chap13.html">Next &gt;&gt;&gt;</A></P>
                </TD>
        -->
    </tr>
  </table>
  <hr>

  <h2><a name="SEC-SPINBUTTONS" id="SEC-SPINBUTTONS"></a>Spin
  Buttons</h2>

  <p>The <i>SpinButton</i> widget is generally used to allow the
  user to select a value from a range of numeric values. It
  consists of a text entry box with up and down arrow buttons
  attached to the side. Selecting one of the buttons causes the
  value to "spin" up and down the range of possible values. The
  entry box may also be edited directly to enter a specific value.
  <i>SpinButton</i> is an instance of <i>EditableClass</i>, so the
  attributes and functions defined there are also available.</p>

  <p>The spin button allows the value to have zero or a number of
  decimal places and to be incremented/decremented in configurable
  steps. The action of holding down one of the buttons optionally
  results in an acceleration of change in the value according to
  how long it is depressed.</p>

  <p><i>SpinButton</i> uses an <i>Adjustment</i> object to hold
  information about the range of values that the spin button can
  take. Recall that an <i>Adjustment</i> widget is created with the
  following function:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
adjustmentNew
               :: Double           -- value
               -&gt; Double           -- lower
               -&gt; Double           -- upper
               -&gt; Double           -- stepIncrement
               -&gt; Double           -- pageIncrement
               -&gt; Double           -- pageSize
               -&gt; IO Adjustment
</pre>
      </td>
    </tr>
  </table>

  <p>These attributes of an <i>Adjustment</i> are used by the
  <i>SpinButton</i> in the following way:</p>

  <ul>
    <li>value: initial value for the Spin Button</li>

    <li>lower: lower range value</li>

    <li>upper: upper range value</li>

    <li>stepIncrement: value to increment/decrement when pressing
    mouse button 1 on a button</li>

    <li>pageIncrement: value to increment/decrement when pressing
    mouse button 2 on a button</li>

    <li>pageSize: unused</li>
  </ul>

  <p>Additionally, mouse button 3 can be used to jump directly to
  the upper or lower values when used to select one of the buttons.
  Note that this may depend on the way your mouse is configured on
  your computer system.</p>

  <p>Lets look at how to create a spin button:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
spinButtonNew :: Adjustment -&gt; Double -&gt; Int -&gt; IO SpinButton
</pre>
      </td>
    </tr>
  </table>

  <p>The second argument (climbRate) take a value between 0.0 and
  1.0 and indicates how fast the spin button changes when an arrow
  is clicked on. The third argument specifies the number of decimal
  places to which the value will be displayed.</p>

  <p>There also is a convenience constructor that allows creation
  of a spin button without manually creating an adjustment.</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="0" bgcolor="#E0E0E0">
    <col width="256*">

    <tr>
      <td width="100%">
        <pre>
spinButtonNewWithRange :: Double -&gt; Double -&gt; Double -&gt; IO SpinButton
</pre>
      </td>
    </tr>
  </table>

  <p>The three arguments, all of type <i>Double</i>, specify the
  minum allowable value, the maximum allowable value, and the
  increment added or subtracted by spinning the widget.</p>

  <p>A Spin Button can be reconfigured after creation using the
  following function:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
spinButtonConfigure :: SpinButtonClass self =&gt; self -. Adjustment -&gt; Double -&gt; Int
</pre>
      </td>
    </tr>
  </table>

  <p>The first argument specifies the <i>SpinButton</i> widget that
  is to be reconfigured. The other arguments are the climbRate and
  the number of decimal places (digits) to disply.</p>

  <p>The <i>SpinButton</i> attributes, which can be retrieved and
  changed with the generic <i>get</i> and <i>set</i> functions
  are:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
spinButtonAdjustment :: SpinButtonClass self =&gt; Attr self Adjustment
spinButtonClimbRate  :: SpinButtonClass self =&gt; Attr self Double
spinButtonDigits     :: SpinButtonClass self =&gt; Attr self Int

spinButtonSnapToTicks :: SpinButtonClass self =&gt; Attr self Bool
spinButtonNumeric     :: SpinButtonClass self =&gt; Attr self Bool
spinButtonWrap        :: SpinButtonClass self =&gt; Attr self Bool

spinButtonValue :: SpinButtonClass self =&gt; Attr self Double
</pre>
      </td>
    </tr>
  </table>

  <p>The first three are as discussed before. The attribute
  <i>spinButtonSnapToTicks</i> determines whether erroneous values
  are automatically changed to the spin button's nearest increment
  (default is False). Attribute <i>spinButtonNumeric</i> determines
  whether non-numeric characters should be ignored (default False),
  and <i>spinButtonWrap</i> is used to set whether a spin button
  should wraparound upon reaching its limits (default False).</p>

  <p>Attribute <i>spinButtonValue</i> is used to read the current
  value or set a new value (default is 0).</p>

  <p>To change the value of a spin button you can also use:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="0" bgcolor="#E0E0E0">
    <col width="256*">

    <tr>
      <td width="100%">
        <pre>
spinButtonSpin :: SpinButtonClass self =&gt; self -&gt; SpinType -&gt; Double -&gt; IO ()
</pre>
      </td>
    </tr>
  </table>

  <p>where <i>SpinType</i> determines the kind of change and
  <i>Double</i> (increment) determines the value.</p>

  <p><i>SpinType</i> has the following constructors:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
SpinStepForward
SpinStepBackward
SpinPageForward
SpinPageBackward
SpinHome
SpinEnd
SpinUserDefined
</pre>
      </td>
    </tr>
  </table>

  <p>Many of these settings use values from the <i>Adjustment</i>
  object that is associated with a spin button.
  <i>SpinStepForward</i> and <i>SpinStepBackward</i>change the
  value of the spin button by the amount specified by the
  increment, unless it is equal to 0, in which case the value is
  changed by the value of the stepIncrement in the adjustment.
  <i>SpinPageForward</i> and <i>SpinPageBackward</i> simply alter
  the value of the Spin Button by the increment.
  <i>SpinPageHome</i> and <i>SpinPageEnd</i> set the value to the
  bottom repectively the top of the <i>Adjustment</i> range.
  <i>i&gt;SpinUserDefined</i> simply alters the value of the spin
  button by the specified amount.</p>

  <p>A spin button has an update policy:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
spinButtonUpdatePolicy :: SpinButtonClass self =&gt; Attr self SpinButtonUpdatePolicy
</pre>
      </td>
    </tr>
  </table>

  <p>The constructors of <i>SpinButtonUpdatePolicy</i> are either
  <i>UdateAlways</i> or <i>UpdateIfValid</i>. These policies affect
  the behavior of a Spin Button when parsing inserted text and
  synchronizing its value with the values of the Adjustment. In the
  case of <i>UpdateIfValid</i> the spin button only value gets
  changed if the text input is a numeric value within the range
  specified by the Adjustment. Otherwise the text is reset to the
  current value. In case of <i>UpdateAlways</i> we ignore errors
  while converting text into a numeric value.</p>

  <p>Finally, you can explicitly request that a Spin Button update
  itself:</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="2" bgcolor="#E0E0E0">
    <tr>
      <td>
        <pre>
spinButtonUpdate :: SpinButtonClass self =&gt; self -&gt; IO ()
</pre>
      </td>
    </tr>
  </table>

  <p>It's example time again; this is a screenshot after playing
  around with some of the settings.</p>

  <p><img src="./Images/GtkChap12.png" alt="GtkChap12.png" align=
  "bottom"></p>

  <p>The spin buttons have all been created with the following
  function which uses <i>spinButtonNewWithRange</i>. Because the
  stepIncrement will be 1.0 in all cases, this is not a parameter
  in <i>myAddSpinButton</i>.</p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="0" bgcolor="#E0E0E0">
    <col width="256*">

    <tr>
      <td width="100%">
        <pre style="margin-bottom: 0.5cm">
myAddSpinButton :: HBox -&gt; String -&gt; Double -&gt; Double -&gt; IO SpinButton
myAddSpinButton box name min max = do
        vbox &lt;- vBoxNew False 0
        boxPackStart box vbox PackRepel 0
        label &lt;- labelNew (Just name)
        miscSetAlignment label 0.0 0.5
        boxPackStart vbox label PackNatural 0
        spinb &lt;- spinButtonNewWithRange min max 1.0
        boxPackStart vbox spinb PackNatural 0
        return spinb
</pre>
      </td>
    </tr>
  </table>

  <p>In the <i>main</i> function we use one of the spin buttons
  which already exist, but give it a new adjustment with
  <i>spinButtonConfigure</i>. The old limits of -1000.0 and 1000.0
  are now replaced with -100.0 and 100.0. Note the brackets around
  the negative numbers. The initial value is set at 0.0 and the
  step increment is 0.25. The page increment, which is what you get
  when pressing mouse button 2 on the arrow in the spin button, is
  set at 10.0. The page size, which is not used, is 0.0 here.
  Pressing mouse button 3 on an arrow jumps to the appropriate
  limit of -100.0 or 100.0.</p>

  <p>The new signal here is <i>onValueSpinned</i> ,which is emitted
  whenever the user changes the value of a spin button. Here it is
  used to control the number of decimal digits which are to be
  displayed in the spinLarge spin button. Note the rounding of the
  value, which is needed to convert the <i>Double</i> to an
  <i>Integral</i> type.</p>

  <p>In this example we've used the generic <i>get</i> and
  <i>set</i> functions on attributes rather than the corresponding
  functions, which are also available. This is actually the
  recommended style when programming Gtk2Hs, and in the future many
  specific functions will be deprecated.<br></p>

  <table summary="Haskell code" width="100%" border="0"
  cellpadding="2" cellspacing="0" bgcolor="#E0E0E0">
    <col width="256*">

    <tr>
      <td width="100%">
        <pre>
import Graphics.UI.Gtk

main:: IO ()
main = do
     initGUI
     window &lt;- windowNew
     mainbox &lt;- vBoxNew False 0
     set window [windowTitle := "Spin Buttons", containerBorderWidth := 10,
                                 windowDefaultWidth := 250,
                                 windowDefaultHeight := 200,
                                 containerChild := mainbox ]
     hbox1 &lt;- hBoxNew False 0 
     frame1 &lt;- frameNew
     set frame1 [frameLabel := "Simple SpinButtons", containerChild := hbox1,
                 frameLabelYAlign := 0.8, frameShadowType := ShadowOut]              
     boxPackStart mainbox frame1 PackNatural 5
 
     spinD &lt;- myAddSpinButton hbox1 "Day:" 1.0 31.0
     spinM &lt;- myAddSpinButton hbox1 "Month:" 1.0 12.0
     spinY &lt;- myAddSpinButton hbox1 "Year:" 2000.0 2100.0
     set spinY [spinButtonValue := 2007]

     vbox1 &lt;- vBoxNew False 5
     frame2 &lt;- frameNew
     set frame2 [frameLabel := "More Features", containerChild := vbox1,
                  frameLabelYAlign := 0.8, frameShadowType:= ShadowOut ]
     boxPackStart mainbox frame2 PackNatural 5
  
     hbox2 &lt;- hBoxNew False 0
     boxPackStart vbox1 hbox2 PackNatural 0     

     spinLarge &lt;- myAddSpinButton hbox2 "Value:" (-1000.0) 1000.0
     adj &lt;- adjustmentNew 0.0 (-100.0) 100.0 0.25 10.0 0.0
     spinButtonConfigure spinLarge adj 0.0 2
     spnctl &lt;- myAddSpinButton hbox2 "Decimal:" 0.0 10.0    
     set spnctl [spinButtonValue := 2.0]
   
     tsnap &lt;- checkButtonNewWithLabel "Snap to 0.25-ticks"
     boxPackStart vbox1 tsnap PackNatural 0

     tnumr &lt;- checkButtonNewWithLabel "Numeric only input mode"   
     boxPackStart vbox1 tnumr PackNatural 0

     twrap &lt;- checkButtonNewWithLabel "Wraparound at limits"   
     boxPackStart vbox1 twrap PackNatural 0

     widgetShowAll window

     onValueSpinned spnctl $ do newdig &lt;- get spnctl spinButtonValue
                                set spinLarge [spinButtonDigits := (round newdig)]

     onToggled tsnap $ do st &lt;- get tsnap toggleButtonActive
                          set spinLarge [spinButtonSnapToTicks := st]

     onToggled tnumr $ do st &lt;- get tnumr toggleButtonActive
                          set spinLarge [spinButtonNumeric := st]

     onToggled twrap $ do st &lt;- get twrap toggleButtonActive
                          set spinLarge [spinButtonWrap := st]

     onDestroy window mainQuit
     mainGUI
</pre>
      </td>
    </tr>
  </table><br>

  <table summary="links to other pages" width="100%" border="0"
  cellpadding="0" cellspacing="0">
    <tr valign="top">
      <td width="33%">
        <p align="left"><a href="chap11.html">&lt;&lt;&lt;
        Previous</a></p>
      </td>

      <td width="34%">
        <p align="center"><a href="chap1.html">Home</a></p>
      </td><!--
                <TD WIDTH=33%>
                        <P ALIGN=RIGHT><A HREF="chap13.html">Next &gt;&gt;&gt;</A></P>
                </TD>
                -->
    </tr>

    <tr valign="top">
      <td width="33%">
        <p align="left">Text Entries and Status Bars</p>
      </td>

      <td width="34%">
        <p align="center"><br></p>
      </td>

      <td width="33%">
        <p align="right">To be continued</p>
      </td>
    </tr>
  </table>
</body>
</html>
